
  def validate_fit_data(estimator, X, y):
      y_array = np.asarray(y)
      if y_array.ndim > 1 and y_array.shape[1] == 1:
          y_array = y_array.reshape(-1)     # makes sklearn happy

      X_checked, y_checked = check_X_y(
          X,
          y_array,
          accept_sparse=False,
          ensure_2d=True,
          ensure_min_samples=1,
          force_all_finite=True,
          y_numeric=(estimator.task == TaskType.REGRESSION),
      )

      # ... feature-name bookkeeping ...

      if estimator.task == TaskType.CLASSIFICATION:
          check_classification_targets(y_checked)
          estimator.classes_ = np.unique(y_checked)

      if estimator.task == TaskType.REGRESSION:
          y_checked = y_checked[:, None]    # restore column for the Gaussian NLL

      return X_checked, y_checked
